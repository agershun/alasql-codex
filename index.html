<!DOCTYPE HTML>
<html>
    <head>
    <title>AlaSQL Code Examples</title>
    <link rel="stylesheet" href="lib/webix/skins/compact.css" type="text/css" media="screen" charset="utf-8">
<!--    <link rel="stylesheet" href="lib/webix/webix.css" type="text/css">  -->
    <script src="lib/webix/webix.js" type="text/javascript"></script>  

    <script type="text/javascript">
      webix.require.disabled = true;
      webix.codebase = "lib/codemirror/";
    </script>
    <script src="lib/webix/codemirror.js"></script>
    <script src="lib/codemirror/codemirror.js"></script>
    <script src="lib/codemirror/javascript.js"></script>
    <script src="lib/codemirror/sql.js"></script>
    <link rel="stylesheet" type="text/css" href="lib/codemirror/codemirror.css">
   
    <script src="lib/marked/marked.js"></script>
    <script src="lib/alasql/alasql.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/codex.css">

    <!-- CODEX FILES -->
    <script src="js/options.js"></script>
    <script src="js/loadfile.js"></script>

    </head>
    <body>
        <script type="text/javascript" charset="utf-8">


  var exdata = [
    {id:0,value:'Welcome to AlaSQL',url:'index.txt'},
    {id:1,value:'Welcome to AlaSQL',desc:'# Welcome to AlaSQL Code Examples! \n```sql\nSELECT 100\n```\nThis is a text'},
    {id:2,value:'SELECT',sql:'SELECT 100'},
    {id:3,value:'SELECT',js:'console.log("Ok!")'}
  ];

  ;

  webix.ready(function(){

    // Define about popup
    webix.ui({view:"popup",id:"about_pop",
      width:300,height:150,
      body:{template:'AlaSQL Code Examples<br>(c) 2015 Andrey Gershun'}
    });

    // Define main window
    webix.ui({rows:[
        {view:"toolbar", paddingY:2,
            elements:[
              { id:'title', view:'label',template: "" },
              {view:"icon",width: 40, icon:"question-circle", popup: "about_pop" }
          ]},

      {cols:[
        {width:250, rows: [
          { type:"header", template:"Examples" },
          { id:'extree',view:"tree", gravity:0.4, select:true,
            data: exdata
          },
        ]},
        { view:"resizer" },        
        {rows: [
          {rows: [
              {
                  borderless:true, view:"tabbar", id:'editbar', value: 'listView', multiview:true, options: [
                      { value: 'Description', id: 'descView'},
                      { value: 'SQL Data Model', id: 'ddlView'},
                      { value: 'SQL Query', id: 'sqlView'},
                      { value: 'JavaScript', id: 'jsView'},
                  ]
              },
              { cells:[ 
                  {id:"descView", template:"Description"},
                  {id:"ddlView", view:"codemirror-editor", mode:'text/x-sql'},
                  {id:"sqlView", view:"codemirror-editor", mode:'text/x-sql'},
                  {id:"jsView", view:"codemirror-editor", mode:'text/x-javascript'}
              ]}
          ]},

          { view:"resizer" },
          {rows: [
            {view:"toolbar", paddingY:2,
            cols:[
              { view:"button", label:"Prev", type:"prev", width:100, height:20 },
              { view:"button", label:"Next" , type:"next",  width:100 },
              { view:"button", label:"Run query" , css:'query_btn', inputWidth:100, align:"right" },
            ]},
//            { type:"header", template:"Result" },
            {template:''}            
          ]},
        ]},
        { view:"resizer" },
        {width:200, view:'accordion',rows: [
          { header:"Tables", headerAlt:"Tables",
            body: { id:'dbtree',view:"tree", gravity:0.4, select:true },
          },
          { header:"Functions", headerAlt:"Functions", 
            body:{
             id:'fntable',view:"datatable",header:false,columns:[
              {id:'fnid',sort:'string'},
              {id:'value'},
             ] 
           },          
          },
          { header:"Variables", headerAlt:"Variables", 
            body:{
             id:'vartable',view:"datatable",header:false,columns:[
              {id:'varid',sort:'string'},
              {id:'value'},
             ] 
           },          
          },
          { header:"Parameters", headerAlt:"Parameters", 
            body:{
             id:'partable',view:"datatable",header:false,columns:[
              {id:'parid',sort:'string'},
              {id:'value'},
             ] 
           },          
          },
          { header:"Options", headerAlt:"Options",
            body:{
             id:'opttable',view:"datatable",header:false,columns:[
              {id:'optid',sort:'string'},
              {id:'value'},
             ] 
           },          
          },
        ]},
      ]},
    ]});
  
    // Set label AlaSQL version
    $$('title').setHTML("<span class='main_title'> <a href='http://alasql.org' style='color:white;font-weight:bold;text-decoration:none'>AlaSQL</a> Code Examples v"+alasql.version+"</span>");

    showTables();
    showOptions();
    showFunctions();
    showVariables();
    showParams();

    $$('extree').attachEvent("onAfterSelect", function (id) {
      var item = $$('extree').getSelectedItem();

      if(item.url && !item.desc && !item.ddl && !item.sql && !item.js) {
        // Load file and tree

        loadFile(id,item);

        item.src = undefined;
      };

      if(item.desc) {
        $$('descView').setHTML(marked(item.desc));
        $$('editbar').setValue('descView');
      };
      if(item.ddl) {
        $$('ddlView').setValue(item.ddl);
        $$('editbar').setValue('ddlView');
      };
      if(item.sql) {
        $$('sqlView').setValue(item.sql);
        $$('editbar').setValue('sqlView');
      };
      if(item.js) {
        $$('jsView').setValue(item.js);
        $$('editbar').setValue('jsView');
      };
    });

    $$('extree').select(0);


  });





        </script>
    </body>
</html>

